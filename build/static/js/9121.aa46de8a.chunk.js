(self.webpackChunkweb_app=self.webpackChunkweb_app||[]).push([[9121],{59121:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>f});var l=a(72791),n=a(99779),o=a(78687),s=a(95087),c=a(29945),r=a(44690),i=a(45248),d=a(26824),u=a(5172),x=a(87995),h=a(27454),p=a(79844),g=a(61342),b=a(80184),m=null;const f=()=>{const e=(0,r.TL)(),t=(0,o.v9)((e=>e.trace.messages)),a=(0,o.v9)((e=>e.trace.traceStarted)),[f,v]=(0,l.useState)(""),[j,w]=(0,l.useState)(""),[y,S]=(0,l.useState)(""),[k,C]=(0,l.useState)(""),[_,T]=(0,l.useState)(0),[N,F]=(0,l.useState)(!1),[z,O]=(0,l.useState)(!0),[W,Z]=(0,l.useState)(!1),[I,E]=(0,l.useState)(!1),[L,J]=(0,l.useState)(!1),[K,M]=(0,l.useState)(!1),[X,R]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{e((0,x.Sc)("trace"))}),[]),(0,b.jsxs)(l.Fragment,{children:[(0,b.jsx)(p.Z,{label:"Trace",actions:(0,b.jsx)(g.Z,{})}),(0,b.jsx)(c.Xgh,{children:(0,b.jsx)(c.xuv,{withBorders:!0,children:(0,b.jsxs)(c.rjZ,{container:!0,children:[(0,b.jsxs)(c.rjZ,{item:!0,xs:12,sx:{display:"flex",flexFlow:"column","& .trace-Checkbox-label":{fontSize:"14px",fontWeight:"normal"}},children:[(0,b.jsx)(c.xuv,{sx:{fontSize:"16px",fontWeight:600,padding:"20px 0px 20px 0"},children:"Calls to Trace"}),(0,b.jsxs)(c.xuv,{className:"".concat(a?"inactive-state":""),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,b.jsxs)(c.xuv,{sx:{display:"flex",flexFlow:"row","& .trace-checked-icon":{border:"1px solid red"},["@media (min-width: ".concat(c.Egj.md,"px)")]:{gap:30}},children:[(0,b.jsx)(c.XZJ,{checked:N,id:"all_calls",name:"all_calls",label:"All",onChange:()=>{F(!N)},value:"all",disabled:a}),(0,b.jsx)(c.XZJ,{checked:z||N,id:"s3_calls",name:"s3_calls",label:"S3",onChange:()=>{O(!z)},value:"s3",disabled:N||a}),(0,b.jsx)(c.XZJ,{checked:W||N,id:"internal_calls",name:"internal_calls",label:"Internal",onChange:()=>{Z(!W)},value:"internal",disabled:N||a}),(0,b.jsx)(c.XZJ,{checked:I||N,id:"storage_calls",name:"storage_calls",label:"Storage",onChange:()=>{E(!I)},value:"storage",disabled:N||a}),(0,b.jsx)(c.XZJ,{checked:L||N,id:"os_calls",name:"os_calls",label:"OS",onChange:()=>{J(!L)},value:"os",disabled:N||a})]}),(0,b.jsxs)(c.xuv,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"15px"},children:[(0,b.jsx)(h.Z,{tooltip:"More filter options",children:(0,b.jsx)(c.zxk,{id:"filter-toggle",onClick:()=>{R(!X)},label:"Filters",icon:(0,b.jsx)(c.k1n,{}),variant:"regular",className:"filters-toggle-button",style:{width:"118px",background:X?"rgba(8, 28, 66, 0.04)":""}})}),!a&&(0,b.jsx)(c.zxk,{id:"start-trace",label:"Start","data-test-id":"trace-start-button",variant:"callAction",onClick:()=>{e((0,u.At)());const t=new URL(window.location.toString()),a=t.port;let l="".concat(z?"s3,":"").concat(W?"internal,":"").concat(I?"storage,":"").concat(L?"os,":"");N&&(l="all");const o=new URL(document.baseURI).pathname,c=(0,d.x2)(t.protocol);m=new s.w3cwebsocket("".concat(c,"://").concat(t.hostname,":").concat(a).concat(o,"ws/trace?calls=").concat(l,"&threshold=").concat(_,"&onlyErrors=").concat(K?"yes":"no","&statusCode=").concat(f,"&method=").concat(j,"&funcname=").concat(y,"&path=").concat(k));let r=null;if(null!==m)return m.onopen=()=>{console.log("WebSocket Client Connected"),e((0,u.qv)(!0)),m.send("ok"),r=setInterval((()=>{m.send("ok")}),1e4)},m.onmessage=t=>{let a=JSON.parse(t.data.toString());a.ptime=n.ou.fromISO(a.time).toJSDate(),a.key=Math.random(),e((0,u.ho)(a))},m.onclose=()=>{clearInterval(r),console.log("connection closed by server"),e((0,u.qv)(!1))},()=>{m.close(1e3),clearInterval(r),console.log("closing websockets"),(0,u.qv)(!1)}},style:{width:"118px"}}),a&&(0,b.jsx)(c.zxk,{id:"stop-trace",label:"Stop Trace","data-test-id":"trace-stop-button",variant:"callAction",onClick:()=>{m.close(1e3),e((0,u.qv)(!1))},style:{width:"118px"}})]})]})]}),X?(0,b.jsxs)(c.xuv,{useBackground:!0,className:"".concat(a?"inactive-state":""),sx:{marginTop:"25px",display:"flex",flexFlow:"column",padding:"30px",width:"100%","& .orient-vertical":{flexFlow:"column","& label":{marginBottom:"10px",fontWeight:600},"& .inputRebase":{width:"90%"}},"& .trace-Checkbox-label":{fontSize:"14px",fontWeight:"normal"}},children:[(0,b.jsxs)(c.xuv,{sx:{display:"flex"},children:[(0,b.jsx)(c.Wzg,{className:"orient-vertical",id:"trace-status-code",name:"trace-status-code",label:"Status Code",placeholder:"e.g. 503",value:f,onChange:e=>{v(e.target.value)},disabled:a}),(0,b.jsx)(c.Wzg,{className:"orient-vertical",id:"trace-function-name",name:"trace-function-name",label:"Function Name",placeholder:"e.g. FunctionName2055",value:y,onChange:e=>{S(e.target.value)},disabled:a}),(0,b.jsx)(c.Wzg,{className:"orient-vertical",id:"trace-method",name:"trace-method",label:"Method",placeholder:"e.g. Method 2056",value:j,onChange:e=>{w(e.target.value)},disabled:a})]}),(0,b.jsxs)(c.xuv,{sx:{gap:"30px",display:"grid",gridTemplateColumns:"2fr 1fr",width:"100%",marginTop:"33px"},children:[(0,b.jsx)(c.xuv,{sx:{flex:2,width:"calc( 100% + 10px)"},children:(0,b.jsx)(c.Wzg,{className:"orient-vertical",id:"trace-path",name:"trace-path",label:"Path",placeholder:"e.g. my-bucket/my-prefix/*",value:k,onChange:e=>{C(e.target.value)},disabled:a})}),(0,b.jsx)(c.xuv,{sx:{marginLeft:"15px"},children:(0,b.jsx)(c.Wzg,{className:"orient-vertical",id:"trace-fthreshold",name:"trace-fthreshold",label:"Response Threshold",type:"number",placeholder:"e.g. website.io.3249.114.12",value:"".concat(_),onChange:e=>{T(parseInt(e.target.value))},disabled:a})})]}),(0,b.jsx)(c.xuv,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-start",marginTop:"40px"},children:(0,b.jsx)(c.XZJ,{checked:K,id:"only_errors",name:"only_errors",label:"Display only Errors",onChange:()=>{M(!K)},value:"only_errors",disabled:a})})]}):null,(0,b.jsx)(c.rjZ,{item:!0,xs:12,children:(0,b.jsx)(c.xuv,{sx:{fontSize:"16px",fontWeight:600,marginBottom:"30px",marginTop:"30px"},children:"Trace Results"})}),(0,b.jsx)(c.rjZ,{item:!0,xs:12,children:(0,b.jsx)(c.wQF,{columns:[{label:"Time",elementKey:"ptime",renderFunction:e=>{const t=new Date(e);return(0,i.zk)(t)},width:100},{label:"Name",elementKey:"api"},{label:"Status",elementKey:"",renderFunction:e=>"".concat(e.statusCode," ").concat(e.statusMsg),renderFullObject:!0},{label:"Location",elementKey:"configuration_id",renderFunction:e=>"".concat(e.host," ").concat(e.client),renderFullObject:!0},{label:"Load Time",elementKey:"callStats.duration",width:150},{label:"Upload",elementKey:"callStats.rx",renderFunction:i.ae,width:150},{label:"Download",elementKey:"callStats.tx",renderFunction:i.ae,width:150}],isLoading:!1,records:t,entityName:"Traces",idField:"api",customEmptyMessage:a?"No Traced elements received yet":"Trace is not started yet",customPaperHeight:"calc(100vh - 292px)",autoScrollToBottom:!0})})]})})})]})}},94210:e=>{var t=function(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;if("object"===typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},95087:(e,t,a)=>{var l;if("object"===typeof globalThis)l=globalThis;else try{l=a(94210)}catch(c){}finally{if(l||"undefined"===typeof window||(l=window),!l)throw new Error("Could not determine global this")}var n=l.WebSocket||l.MozWebSocket,o=a(51496);function s(e,t){return t?new n(e,t):new n(e)}n&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(s,e,{get:function(){return n[e]}})})),e.exports={w3cwebsocket:n?s:null,version:o}},51496:(e,t,a)=>{e.exports=a(19794).version},19794:e=>{"use strict";e.exports={version:"1.0.34"}}}]);
//# sourceMappingURL=9121.aa46de8a.chunk.js.map