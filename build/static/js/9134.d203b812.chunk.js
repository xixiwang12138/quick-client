"use strict";(self.webpackChunkweb_app=self.webpackChunkweb_app||[]).push([[9134],{58400:(e,l,t)=>{t.d(l,{Z:()=>p});var s=t(72791),i=t(29945),n=t(21639),c=t(59114),o=t(87995),a=t(44690),r=t(74616),d=t(78687),u=t(31776),h=t(80184);const p=e=>{let{noTitle:l=!1}=e;const t=(0,a.TL)(),[p,x]=(0,s.useState)([]),[v,j]=(0,s.useState)(!1),[m,b]=(0,s.useState)(""),g=(0,d.v9)((e=>e.createUser.selectedPolicies)),f=(0,s.useCallback)((()=>{j(!0),u.h.policies.listPolicies().then((e=>{var l;const t=null!==(l=e.data.policies)&&void 0!==l?l:[];j(!1),x(t.sort(n.g4))})).catch((e=>{j(!1),t((0,o.zb)(e))}))}),[t]);(0,s.useEffect)((()=>{j(!0)}),[]),(0,s.useEffect)((()=>{v&&f()}),[v,f]);const y=p.filter((e=>e.name.includes(m)));return(0,h.jsxs)(i.rjZ,{item:!0,xs:12,className:"inputItem",children:[v&&(0,h.jsx)(i.kod,{}),p.length>0?(0,h.jsxs)(s.Fragment,{children:[(0,h.jsx)(i.rjZ,{item:!0,xs:12,className:"inputItem",children:(0,h.jsx)(c.Z,{placeholder:"Start typing to search for a Policy",onChange:e=>{b(e)},value:m,label:l?"":"Assign Policies"})}),(0,h.jsx)(i.wQF,{columns:[{label:"Policy",elementKey:"name"}],onSelect:e=>{const l=e.target,s=l.value,i=l.checked;let n=[...g];i?n.push(s):n=n.filter((e=>e!==s)),n=n.filter((e=>""!==e)),t((0,r.ue)(n))},selectedItems:g,isLoading:v,records:y,entityName:"Policies",idField:"name",customPaperHeight:"200px"})]}):(0,h.jsx)(i.xuv,{sx:{textAlign:"center",padding:"10px 0"},children:"No Policies Available"})]})}},39134:(e,l,t)=>{t.r(l),t.d(l,{default:()=>m});var s=t(72791),i=t(26181),n=t.n(i),c=t(78687),o=t(29945),a=t(45248),r=t(87995),d=t(44690),u=t(23814),h=t(74616),p=t(56028),x=t(58400),v=t(81207),j=t(80184);const m=e=>{let{closeModalAndRefresh:l,selectedUser:t,selectedGroups:i,open:m}=e;const b=(0,d.TL)(),[g,f]=(0,s.useState)(!1),[y,S]=(0,s.useState)([]),[k,P]=(0,s.useState)([]),Z=(0,c.v9)((e=>e.createUser.selectedPolicies));(0,s.useEffect)((()=>{if(m){if(1===(null===i||void 0===i?void 0:i.length))return void(1===(null===i||void 0===i?void 0:i.length)&&v.Z.invoke("GET","/api/v1/group/".concat((0,a.LL)(i[0]))).then((e=>{const l=n()(e,"policy","");S(l.split(",")),P(l.split(",")),b((0,h.ue)(l.split(",")))})).catch((e=>{b((0,r.zb)(e)),f(!1)})));const e=n()(t,"policy",[]);S(e),P(e),b((0,h.ue)(e))}}),[m,null===i||void 0===i?void 0:i.length,t]);const w=n()(t,"accessKey","");return(0,j.jsxs)(p.Z,{onClose:()=>{l()},modalOpen:m,title:"Set Policies",children:[(0,j.jsxs)(o.ltY,{withBorders:!1,containerPadding:!1,children:[(1===(null===i||void 0===i?void 0:i.length)||null!=t)&&(0,j.jsxs)(s.Fragment,{children:[(0,j.jsx)(o.bSr,{label:"Selected ".concat(null!==i?"Group":"User"),sx:{width:"100%"},children:null!==i?i[0]:w}),(0,j.jsx)(o.bSr,{label:"Current Policy",sx:{width:"100%"},children:y.join(", ")})]}),i&&(null===i||void 0===i?void 0:i.length)>1&&(0,j.jsx)(o.bSr,{label:"Selected Groups",sx:{width:"100%"},children:i.join(", ")}),(0,j.jsx)(o.rjZ,{item:!0,xs:12,children:(0,j.jsx)(x.Z,{selectedPolicy:k})})]}),(0,j.jsxs)(o.rjZ,{item:!0,xs:12,sx:u.ID.modalButtonBar,children:[(0,j.jsx)(o.zxk,{id:"reset",type:"button",variant:"regular",onClick:()=>{P(y),b((0,h.ue)(y))},label:"Reset"}),(0,j.jsx)(o.zxk,{id:"save",type:"button",variant:"callAction",color:"primary",disabled:g,onClick:()=>{let e=null,s=null;null!==i?s=i:null!==t&&(e=[t.accessKey]||0),f(!0),v.Z.invoke("PUT","/api/v1/set-policy-multi",{name:Z,groups:s,users:e}).then((()=>{f(!1),l()})).catch((e=>{f(!1),b((0,r.zb)(e))}))},label:"Save"})]}),g&&(0,j.jsx)(o.rjZ,{item:!0,xs:12,children:(0,j.jsx)(o.kod,{})})]})}}}]);
//# sourceMappingURL=9134.d203b812.chunk.js.map