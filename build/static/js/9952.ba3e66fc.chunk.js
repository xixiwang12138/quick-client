"use strict";(self.webpackChunkweb_app=self.webpackChunkweb_app||[]).push([[9952],{99952:(e,t,s)=>{s.r(t),s.d(t,{default:()=>S});var n=s(72791),a=s(29945),l=s(66315),i=s(31776),o=s(82342),r=s(23814),c=s(87995),d=s(44690),p=s(56087),u=s(38442),m=s(27454),x=s(9505),h=s(23508),b=s(40214),k=s(80184);const y=e=>{let{closeAddModalAndRefresh:t,addOpen:s}=e;const l=(0,d.TL)(),[i,o]=(0,x.Z)((()=>t(!0)),(e=>{t(!1),l((0,c.Ih)(e))})),[r,p]=(0,n.useState)("");return(0,k.jsx)(h.Z,{title:"",confirmText:"Create",isOpen:s,isLoading:i,onConfirm:()=>{o("POST","/api/v1/kms/keys/",{key:r})},onClose:()=>t(!1),confirmButtonProps:{disabled:-1!==r.indexOf(" ")||""===r||i,variant:"callAction"},confirmationContent:(0,k.jsxs)(n.Fragment,{children:[(0,k.jsx)(b.Z,{helpText:"Create Key",contents:["Create a new cryptographic key in the Key Management Service server connected to MINIO."]}),(0,k.jsx)(a.rjZ,{item:!0,xs:12,sx:{marginTop:15},children:(0,k.jsx)(a.Wzg,{id:"key-name",name:"key-name",label:"Key Name",autoFocus:!0,value:r,error:-1!==r.indexOf(" ")?"Key name cannot contain spaces":"",onChange:e=>{p(e.target.value)}})})]})})};var j=s(56028);const S=e=>{let{open:t,encryptionCfg:s,selectedBucket:x,closeModalAndRefresh:h}=e;const b=(0,d.TL)(),[S,f]=(0,n.useState)(!1),[v,g]=(0,n.useState)(""),[C,K]=(0,n.useState)("disabled"),[E,M]=(0,n.useState)([]),[A,I]=(0,n.useState)(!1),[T,B]=(0,n.useState)(!1);(0,n.useEffect)((()=>{s&&("AES256"===s.algorithm?K(l.bJ.SseS3):(K(l.bJ.SseKms),g(s.kmsMasterKeyID||"")))}),[s]),(0,n.useEffect)((()=>{"sse-kms"===C&&i.h.kms.kmsListKeys().then((e=>{M(e.data.results),I(!1)})).catch((e=>{I(!1),b((0,c.zb)((0,o.g)(e.error)))}))}),[C,A,b]);return(0,k.jsxs)(n.Fragment,{children:[T&&(0,k.jsx)(y,{addOpen:T,closeAddModalAndRefresh:e=>{B(!1),I(!0)}}),(0,k.jsx)(j.Z,{modalOpen:t,onClose:()=>{h()},title:"Enable Bucket Encryption",titleIcon:(0,k.jsx)(a.Xn4,{}),children:(0,k.jsx)("form",{noValidate:!0,autoComplete:"off",onSubmit:e=>{e.preventDefault(),S||("disabled"===C?i.h.buckets.disableBucketEncryption(x).then((()=>{f(!1),h()})).catch((async e=>{const t=await e.json();f(!1),b((0,c.zb)((0,o.g)(t)))})):i.h.buckets.enableBucketEncryption(x,{encType:C,kmsKeyID:v}).then((()=>{f(!1),h()})).catch((async e=>{const t=await e.json();f(!1),b((0,c.zb)((0,o.g)(t)))})))},children:(0,k.jsxs)(a.ltY,{withBorders:!1,containerPadding:!1,children:[(0,k.jsx)(a.PhF,{onChange:e=>{K(e)},id:"select-encryption-type",name:"select-encryption-type",label:"Encryption Type",value:C,options:[{label:"Disabled",value:"disabled"},{label:"SSE-S3",value:l.bJ.SseS3},{label:"SSE-KMS",value:l.bJ.SseKms}]}),"sse-kms"===C&&(0,k.jsxs)(a.xuv,{sx:{display:"flex",gap:10},className:"inputItem",children:[E&&(0,k.jsx)(a.PhF,{onChange:e=>{g(e)},id:"select-kms-key-id",name:"select-kms-key-id",label:"KMS Key ID",value:v,options:E.map((e=>({label:e.name||"",value:e.name||""})))}),(0,k.jsx)(u.s,{scopes:[p.Ft.KMS_IMPORT_KEY],resource:p.C3,errorProps:{disabled:!0},children:(0,k.jsx)(m.Z,{tooltip:"Add key",children:(0,k.jsx)(a.zxk,{id:"import-key",variant:"regular",icon:(0,k.jsx)(a.dtP,{}),onClick:e=>{B(!0),e.preventDefault()}})})})]}),(0,k.jsxs)(a.rjZ,{item:!0,xs:12,sx:r.ID.modalButtonBar,children:[(0,k.jsx)(a.zxk,{id:"cancel",type:"submit",variant:"regular",onClick:()=>{h()},disabled:S,label:"Cancel"}),(0,k.jsx)(a.zxk,{id:"save",type:"submit",variant:"callAction",disabled:S,label:"Save"})]}),S&&(0,k.jsx)(a.rjZ,{item:!0,xs:12,children:(0,k.jsx)(a.kod,{})})]})})})]})}},40214:(e,t,s)=>{s.d(t,{Z:()=>i});var n=s(72791),a=s(29945),l=s(80184);const i=e=>{let{helpText:t,contents:s}=e;return(0,l.jsx)(a.KfX,{iconComponent:(0,l.jsx)(a.M9A,{}),title:t,help:(0,l.jsx)(n.Fragment,{children:s.map((e=>(0,l.jsx)(a.xuv,{sx:{paddingBottom:"20px"},children:e})))})})}}}]);
//# sourceMappingURL=9952.ba3e66fc.chunk.js.map